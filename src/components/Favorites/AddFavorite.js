import './AddFavorite.scss';

export default function AddFavorite({city, countryCode}){

    const addToFavorites = () =>{
        
        if(localStorage.getItem('favorites') === undefined || localStorage.getItem('favorites') === null){
            let favorites = [{city, countryCode}];
            localStorage.setItem("favorites", JSON.stringify(favorites));
        }else{
            let favorites = JSON.parse(localStorage.getItem('favorites'));
            for (var i = 0; i < favorites.length; i++){
                if(favorites[i].city == city && favorites[i].countryCode == countryCode){
                   favorites.splice(i,1);
                   localStorage.setItem("favorites", JSON.stringify(favorites));
                   window.location.href = "/favorites";
                   return;
                }
              }
            favorites.push({city, countryCode});
            localStorage.setItem("favorites", JSON.stringify(favorites));
        }
        window.location.href = "/favorites";
    }

    const displayBtn = () =>{
        if((localStorage.getItem('favorites') === undefined || localStorage.getItem('favorites') === null) || JSON.parse(localStorage.getItem('favorites')).length === 0){
            return(
                <>
                <svg width="50" height="50" viewBox="0 0 50 50" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M49 25.5747C49 38.4903 38.2769 49 25 49C11.7231 49 1 38.4903 1 25.5747C1 12.6591 11.7231 2.14941 25 2.14941C38.2769 2.14941 49 12.6591 49 25.5747Z" stroke="white" stroke-width="2"/>
                    <path d="M24.7059 11.4942L28.0076 21.4221H38.692L30.0481 27.5579L33.3498 37.4859L24.7059 31.3501L16.062 37.4859L19.3637 27.5579L10.7198 21.4221H21.4042L24.7059 11.4942Z" fill="white"/>
                    <path d="M48.3235 7.75863C48.3235 10.8043 45.7931 13.2931 42.6471 13.2931C39.501 13.2931 36.9706 10.8043 36.9706 7.75863C36.9706 4.71292 39.501 2.22415 42.6471 2.22415C45.7931 2.22415 48.3235 4.71292 48.3235 7.75863Z" fill="#54BDEA" stroke="white"/>
                    <path d="M42.4307 10.604C42.3507 10.604 42.2827 10.58 42.2267 10.532C42.1787 10.476 42.1547 10.408 42.1547 10.328V7.832H39.6947C39.6147 7.832 39.5467 7.808 39.4907 7.76C39.4427 7.704 39.4187 7.636 39.4187 7.556V7.172C39.4187 7.092 39.4427 7.028 39.4907 6.98C39.5467 6.924 39.6147 6.896 39.6947 6.896H42.1547V4.472C42.1547 4.392 42.1787 4.328 42.2267 4.28C42.2827 4.224 42.3507 4.196 42.4307 4.196H42.8507C42.9307 4.196 42.9947 4.224 43.0427 4.28C43.0987 4.328 43.1267 4.392 43.1267 4.472V6.896H45.5987C45.6787 6.896 45.7427 6.924 45.7907 6.98C45.8467 7.028 45.8747 7.092 45.8747 7.172V7.556C45.8747 7.636 45.8467 7.704 45.7907 7.76C45.7427 7.808 45.6787 7.832 45.5987 7.832H43.1267V10.328C43.1267 10.408 43.0987 10.476 43.0427 10.532C42.9947 10.58 42.9307 10.604 42.8507 10.604H42.4307Z" fill="white"/>
                </svg>
                <h3 style={{color:"white", fontWeight:"normal"}}>Ajouter aux favoris</h3>
                </>
            )
        }else{
            let favorites = JSON.parse(localStorage.getItem('favorites'));
            for (var i = 0; i < favorites.length; i++){
                if (favorites[i].city == city && favorites[i].countryCode == countryCode){
                   return(
                    <>
                        <svg width="50" height="50" viewBox="0 0 85 87" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="42.5" cy="44.5" r="41.5" stroke="white" stroke-width="2"/>
                            <circle cx="72.5" cy="13.5" r="10" fill="#54BDEA" stroke="white"/>
                            <path d="M69.9963 13.84C69.8629 13.84 69.7496 13.8 69.6563 13.72C69.5763 13.6267 69.5363 13.5133 69.5363 13.38V12.62C69.5363 12.4867 69.5763 12.38 69.6563 12.3C69.7496 12.2067 69.8629 12.16 69.9963 12.16H75.9963C76.1296 12.16 76.2363 12.2067 76.3163 12.3C76.4096 12.38 76.4563 12.4867 76.4563 12.62V13.38C76.4563 13.5133 76.4096 13.6267 76.3163 13.72C76.2363 13.8 76.1296 13.84 75.9963 13.84H69.9963Z" fill="white"/>
                            <path d="M53.2115 31.5H47.0769V30.375C47.0769 28.514 45.5758 27 43.7308 27H39.2692C37.4242 27 35.9231 28.514 35.9231 30.375V31.5H29.7885C28.2509 31.5 27 32.7617 27 34.3125V38.25C27 38.8713 27.4994 39.375 28.1154 39.375H28.7249L29.6886 59.7855C29.7737 61.5881 31.2418 63 33.0309 63H49.9691C51.7583 63 53.2264 61.5881 53.3114 59.7855L54.2751 39.375H54.8846C55.5006 39.375 56 38.8713 56 38.25V34.3125C56 32.7617 54.7491 31.5 53.2115 31.5ZM38.1538 30.375C38.1538 29.7547 38.6542 29.25 39.2692 29.25H43.7308C44.3458 29.25 44.8462 29.7547 44.8462 30.375V31.5H38.1538V30.375ZM29.2308 34.3125C29.2308 34.0024 29.481 33.75 29.7885 33.75H53.2115C53.519 33.75 53.7692 34.0024 53.7692 34.3125V37.125C53.4255 37.125 30.6552 37.125 29.2308 37.125V34.3125ZM51.0832 59.6785C51.0548 60.2793 50.5654 60.75 49.9691 60.75H33.0309C32.4345 60.75 31.9451 60.2793 31.9168 59.6785L30.9582 39.375H52.0418L51.0832 59.6785Z" fill="white"/>
                        </svg>
                        <h3 style={{color:"white", fontWeight:"normal"}}>Supprimer des favoris</h3>
                    </>
                   )
                }else{
                    return(
                        <>
                            <svg width="50" height="50" viewBox="0 0 50 50" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M49 25.5747C49 38.4903 38.2769 49 25 49C11.7231 49 1 38.4903 1 25.5747C1 12.6591 11.7231 2.14941 25 2.14941C38.2769 2.14941 49 12.6591 49 25.5747Z" stroke="white" stroke-width="2"/>
                                <path d="M24.7059 11.4942L28.0076 21.4221H38.692L30.0481 27.5579L33.3498 37.4859L24.7059 31.3501L16.062 37.4859L19.3637 27.5579L10.7198 21.4221H21.4042L24.7059 11.4942Z" fill="white"/>
                                <path d="M48.3235 7.75863C48.3235 10.8043 45.7931 13.2931 42.6471 13.2931C39.501 13.2931 36.9706 10.8043 36.9706 7.75863C36.9706 4.71292 39.501 2.22415 42.6471 2.22415C45.7931 2.22415 48.3235 4.71292 48.3235 7.75863Z" fill="#54BDEA" stroke="white"/>
                                <path d="M42.4307 10.604C42.3507 10.604 42.2827 10.58 42.2267 10.532C42.1787 10.476 42.1547 10.408 42.1547 10.328V7.832H39.6947C39.6147 7.832 39.5467 7.808 39.4907 7.76C39.4427 7.704 39.4187 7.636 39.4187 7.556V7.172C39.4187 7.092 39.4427 7.028 39.4907 6.98C39.5467 6.924 39.6147 6.896 39.6947 6.896H42.1547V4.472C42.1547 4.392 42.1787 4.328 42.2267 4.28C42.2827 4.224 42.3507 4.196 42.4307 4.196H42.8507C42.9307 4.196 42.9947 4.224 43.0427 4.28C43.0987 4.328 43.1267 4.392 43.1267 4.472V6.896H45.5987C45.6787 6.896 45.7427 6.924 45.7907 6.98C45.8467 7.028 45.8747 7.092 45.8747 7.172V7.556C45.8747 7.636 45.8467 7.704 45.7907 7.76C45.7427 7.808 45.6787 7.832 45.5987 7.832H43.1267V10.328C43.1267 10.408 43.0987 10.476 43.0427 10.532C42.9947 10.58 42.9307 10.604 42.8507 10.604H42.4307Z" fill="white"/>
                            </svg>
                            <h3 style={{color:"white", fontWeight:"normal"}}>Ajouter aux favoris</h3>
                        </>
                    )
                }
              }
        }
    }

    return(
        <>
            <button className="addBtn" onClick={()=>{addToFavorites()}}>
                {displayBtn()}
            </button>
        </>
    )
}